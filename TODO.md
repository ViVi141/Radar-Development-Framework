# TODO — Radar Development Framework

本文档记录待实现功能与改进项，优先以**以电磁波为载体的雷达系统**为主线。

---

## 一、以电磁波为载体的雷达系统（主轨道）

在现有 LiDAR 射线扫描基础上，引入**电磁波**作为载体，使雷达具备波段、频率、波长、相位、衰减、反射等物理特性，并与现有 Core/Visual/Util 结构兼容。

### 1. 电磁波基础模型

- [ ] **波段 / 频率 / 波长**
  - 定义电磁波参数类（如 `RDF_EMWaveParams` 或扩展 `RDF_LidarSettings`）：载波频率 `f`（Hz）、可选波段枚举（如 L/S/C/X/Ku 等）。
  - 波长 `λ = c / f`（c 为光速常量），在材质反射、衰减计算中复用。
  - 在设置中支持按频率或波长配置，并做合理 clamp（例如频率范围 1 MHz～100 GHz）。

- [ ] **相位**
  - 为每条射线/每个回波记录相位信息（如发射相位、回波相位），用于后续多普勒、相干检测扩展。
  - 数据结构中增加 `m_Phase`（或 `m_PhaseRad`）字段；相位可随传播距离变化：`phase = 2π * 2*distance/λ`（往返）。

- [ ] **衰减（传播损耗）**
  - **自由空间路径损耗**：`FSPL = (4π*d*f/c)²` 或 dB 形式 `20*log10(d) + 20*log10(f) + 92.45`（d: km, f: GHz）。
  - 在采样结果中增加「接收功率」或「信号强度」字段，由发射功率减去 FSPL（及后续材质损耗）得到。
  - 可选：简单大气/雨衰模型（与距离、频率相关的额外 dB 衰减）。

- [ ] **反射与 RCS**
  - 命中点处根据**材质/表面**（若引擎暴露 `GameMaterial` 或表面类型）映射到**反射系数**或**雷达截面积（RCS）**简化值。
  - 反射强度 = f(发射功率, 距离衰减, 反射系数/RCS)。
  - 可选：简单镜面/漫反射模型（入射角与反射强度关系）。

### 2. 数据结构与 API

- [ ] **雷达采样类型**
  - 新建 `RDF_RadarSample`（或继承/组合 `RDF_LidarSample`），增加字段：频率/波长、相位、接收功率/强度、反射系数或 RCS、往返时间等。
  - 或在不破坏现有 LiDAR 的前提下，在 Util 中提供「从 LiDAR 采样 + 电磁参数」生成雷达采样的转换层。

- [ ] **雷达设置**
  - 新建 `RDF_RadarSettings`（或扩展现有 Settings）：发射功率、载波频率/波段、是否启用衰减/相位/反射计算、大气/环境参数（若做衰减扩展）。

- [ ] **雷达扫描器**
  - 新建 `RDF_RadarScanner`：在现有射线 Trace 基础上，对每次命中/未命中应用衰减与反射模型，并写入电磁相关字段。
  - 可与 `RDF_LidarScanner` 共用采样策略与 Trace 流程，仅在后处理阶段叠加电磁计算。

### 3. 可视化与演示

- [ ] **雷达回波可视化**
  - 点云/射线颜色或大小与「接收强度」或「信噪比」挂钩（新建或扩展 `RDF_LidarColorStrategy` / 雷达专用 ColorStrategy）。
  - 可选：距离-强度条、简单 PPI 平面显示（若 UI 可行）。

- [ ] **Demo / 预设**
  - 雷达版预设（如 `RDF_RadarDemoConfig`），选择波段、频率、是否显示强度/相位等，与现有 `RDF_LidarAutoRunner` 或新 Runner 集成。

### 4. 文档与测试

- [ ] 在 `docs/API.md` 中增加雷达相关类型与接口说明。
- [ ] 在 `docs/DEVELOPMENT.md` 中说明电磁模型假设与扩展点（频率范围、衰减公式、RCS 简化约定）。
- [ ] 自检或单元测试：给定频率/距离，校验路径损耗与相位计算公式是否正确。

---

## 二、其他待办（可选）

- [ ] 多普勒：若引擎提供命中点或实体速度，可计算多普勒频移并加入雷达采样。
- [ ] 噪声与检测门限：简单噪声模型 + 门限，用于「是否判定为有效回波」。
- [ ] 与现有 LiDAR 的开关/策略复用：雷达与 LiDAR 可共用部分采样策略，仅后端处理不同。

---

## 三、实现顺序建议

1. 电磁波参数（频率/波长/波段）与设置类。
2. 衰减模型（FSPL）与采样结果中的强度字段。
3. 反射/RCS 简化模型与材质映射。
4. 相位字段与计算。
5. 雷达扫描器（基于现有 Trace）与数据结构。
6. 可视化与 Demo 集成。
7. 文档与自检。

---

*最后更新：按「以电磁波为载体的雷达系统」规划整理。*
